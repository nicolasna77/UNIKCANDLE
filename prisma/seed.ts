import { faker } from "@faker-js/faker/locale/fr";
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function main() {
  // Suppression des donn√©es dans l'ordre inverse des d√©pendances
  await prisma.qRCode.deleteMany();
  await prisma.orderItem.deleteMany();
  await prisma.address.deleteMany();
  await prisma.order.deleteMany();
  await prisma.review.deleteMany();
  await prisma.image.deleteMany();
  await prisma.product.deleteMany();
  await prisma.scent.deleteMany();
  await prisma.category.deleteMany();
  await prisma.user.deleteMany();

  // Cr√©ation des cat√©gories
  const categories = [
    {
      name: "Amours et liens",
      description:
        "Des bougies pour exprimer vos sentiments les plus profonds et renforcer vos liens intimes",
      icon: "‚ù§Ô∏è",
      color: "#FF69B4",
    },
    {
      name: "Vie sociale et relations",
      description:
        "Des bougies pour c√©l√©brer vos relations, amiti√©s et moments partag√©s",
      icon: "üë•",
      color: "#4B9CD3",
    },
    {
      name: "Travail et transition",
      description:
        "Des bougies pour accompagner les changements professionnels et les nouveaux d√©fis",
      icon: "üíº",
      color: "#8B5A2B",
    },
    {
      name: "√âmotions et sentiments personnels",
      description:
        "Des bougies pour accompagner votre d√©veloppement personnel et vos √©motions intimes",
      icon: "üåô",
      color: "#6B73FF",
    },
  ];

  const createdCategories = await Promise.all(
    categories.map((category) =>
      prisma.category.create({
        data: category,
      })
    )
  );

  console.log(
    "Cat√©gories cr√©√©es:",
    createdCategories.map((c) => c.id)
  );

  // Cr√©ation des senteurs
  const scents = [
    {
      name: "Rose & Vanille bois√©e",
      description:
        "Un m√©lange envo√ªtant et chaleureux qui √©voque l'intimit√©, la tendresse et l'intensit√© d'un moment sinc√®re",
      icon: "üåπ",
      color: "#FFE5B4",
      notes: ["Rose", "Vanille bois√©e"],
    },
    {
      name: "Fleur de coton & bois blanc",
      description:
        "Une senteur r√©confortante, propre et douce, qui √©voque la tendresse, les souvenirs partag√©s, et le besoin d'√™tre proche",
      icon: "üå∏",
      color: "#F5F5DC",
      notes: ["Fleur de coton", "Bois blanc"],
    },
    {
      name: "Lait d'amande & santal",
      description:
        "Un parfum cr√©meux, chaud et enveloppant qui apaise les tensions et ouvre le c≈ìur",
      icon: "ü•õ",
      color: "#FFF8DC",
      notes: ["Lait d'amande", "Santal"],
    },
    {
      name: "Violette & th√© blanc",
      description:
        "Une fragrance d√©licate et myst√©rieuse, √† la fois florale et a√©rienne, id√©ale pour exprimer des sentiments intimes sans √©clats",
      icon: "üíú",
      color: "#E6E6FA",
      notes: ["Violette", "Th√© blanc"],
    },
    {
      name: "Pivoine fra√Æche & musc doux",
      description:
        "Un parfum l√©ger, fleuri et rassurant qui √©voque la bienveillance et la pr√©sence chaleureuse √† distance",
      icon: "üå∫",
      color: "#FFB6C1",
      notes: ["Pivoine", "Musc doux"],
    },
    {
      name: "Menthe poivr√©e & eucalyptus doux",
      description:
        "Un parfum frais et optimiste qui √©voque les d√©buts, la respiration, et l'√©nergie d'un nouveau rendez-vous √† venir",
      icon: "üåø",
      color: "#98FB98",
      notes: ["Menthe poivr√©e", "Eucalyptus doux"],
    },
    {
      name: "Ambre & figue noire",
      description:
        "Un parfum profond, sensuel et l√©g√®rement sucr√©, qui √©voque la nostalgie, l'√©l√©gance et la trace d'un lien qui a compt√©",
      icon: "üü§",
      color: "#8B4513",
      notes: ["Ambre", "Figue noire"],
    },
    {
      name: "C√®dre blanc & lavande apaisante",
      description:
        "Un parfum bois√© et r√©confortant, avec une touche florale, propice √† l'apaisement et √† la confiance",
      icon: "üå≤",
      color: "#F0F8FF",
      notes: ["C√®dre blanc", "Lavande apaisante"],
    },
    {
      name: "Fleur d'oranger & miel chaud",
      description:
        "Un parfum enveloppant, solaire et g√©n√©reux, qui respire la douceur, l'admiration et l'affection",
      icon: "üçØ",
      color: "#FFD700",
      notes: ["Fleur d'oranger", "Miel chaud"],
    },
    {
      name: "Patchouli doux & vanille noire",
      description:
        "Un parfum profond, enveloppant et sensuel, parfait pour √©voquer la nostalgie et la tendresse m√™l√©es √† l'envie de recommencer",
      icon: "üü´",
      color: "#8B4513",
      notes: ["Patchouli doux", "Vanille noire"],
    },
  ];

  const createdScents = await Promise.all(
    scents.map((scent) =>
      prisma.scent.create({
        data: scent,
      })
    )
  );

  console.log(
    "Senteurs cr√©√©es:",
    createdScents.map((s) => s.id)
  );

  // Cr√©ation des produits UNIKCANDLE
  const products = [
    {
      name: "D√©clare ta flamme",
      subTitle: "Certaines choses ne se disent qu'en lumi√®re",
      description:
        'Voici la bougie parfaite pour oser dire ce que l\'on tait depuis trop longtemps. "D√©clare ta flamme" est une invitation douce, √©l√©gante et personnelle √† d√©voiler ses sentiments de mani√®re originale et inoubliable.',
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Certaines choses ne se disent qu'en lumi√®re",
      arAnimation: "feu-de-braises",
      scentId: createdScents[0].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Tu me manques",
      subTitle: "Quand les mots ne suffisent pas, la flamme parle pour vous",
      description:
        'Parfaite pour combler la distance, "Tu me manques" transmet une √©motion profonde sans avoir √† en dire trop. Une bougie pour faire sentir sa pr√©sence malgr√© l\'absence.',
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Quand les mots ne suffisent pas, la flamme parle pour vous",
      arAnimation: "ciel-etoile",
      scentId: createdScents[1].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Pardon",
      subTitle: "Un geste de lumi√®re pour r√©parer les silences",
      description:
        'Quand les mots sont difficiles √† dire, cette bougie est l√† pour apaiser, pour exprimer des regrets sinc√®res, pour demander pardon autrement. "Pardon" est une bougie empreinte de douceur et d\'√©l√©gance, con√ßue pour retisser un lien bless√©.',
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Un geste de lumi√®re pour r√©parer les silences",
      arAnimation: "pluie-soleil",
      scentId: createdScents[2].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Je t'aime en silence",
      subTitle: "Certains sentiments brillent sans faire de bruit",
      description:
        "Con√ßue pour ceux qui aiment avec retenue, pudeur ou timidit√©, \"Je t'aime en silence\" est la bougie des √©motions discr√®tes mais profondes. Une fa√ßon √©l√©gante de r√©v√©ler ce qui ne s'est jamais dit √† voix haute.",
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Certains sentiments brillent sans faire de bruit",
      arAnimation: "clair-de-lune",
      scentId: createdScents[3].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Je pense √† toi",
      subTitle: "Une pens√©e qui s'allume, un lien qui ne s'√©teint pas",
      description:
        "Une bougie simple et sinc√®re, id√©ale pour rappeler √† quelqu'un qu'on ne l'a pas oubli√©. \"Je pense √† toi\" est le petit geste symbolique qui dit beaucoup, sans occasion particuli√®re, juste pour entretenir le lien.",
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Une pens√©e qui s'allume, un lien qui ne s'√©teint pas",
      arAnimation: "brise-fleurs",
      scentId: createdScents[4].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "√Ä bient√¥t",
      subTitle: "Ce n'est qu'un au revoir, dit avec chaleur",
      description:
        '"√Ä bient√¥t" est la bougie parfaite pour accompagner un d√©part, une s√©paration temporaire ou un petit √©loignement. Elle transmet douceur, espoir et certitude qu\'on se retrouvera bient√¥t, malgr√© les kilom√®tres ou les circonstances.',
      price: 49.99,
      categoryId: createdCategories[1].id, // Vie sociale
      slogan: "Ce n'est qu'un au revoir, dit avec chaleur",
      arAnimation: "lever-soleil",
      scentId: createdScents[5].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Un amour pass√©",
      subTitle: "Parce que certains souvenirs m√©ritent une derni√®re lumi√®re",
      description:
        '"Un amour pass√©" est une bougie con√ßue pour honorer une histoire r√©volue, mais pr√©cieuse. Elle accompagne les adieux doux, les pages tourn√©es, et les chapitres qui laissent encore un peu de chaleur dans le c≈ìur.',
      price: 49.99,
      categoryId: createdCategories[0].id, // Amour
      slogan: "Parce que certains souvenirs m√©ritent une derni√®re lumi√®re",
      arAnimation: "feuilles-automne",
      scentId: createdScents[6].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Je suis l√†",
      subTitle: "M√™me sans paroles, ma pr√©sence t'accompagne",
      description:
        "\"Je suis l√†\" est une bougie pens√©e pour soutenir, r√©conforter ou simplement faire sentir sa pr√©sence. Un geste silencieux, tendre et profond, pour rappeler √† l'autre qu'il n'est pas seul.",
      price: 49.99,
      categoryId: createdCategories[1].id, // Vie sociale
      slogan: "M√™me sans paroles, ma pr√©sence t'accompagne",
      arAnimation: "lumiere-tamisee",
      scentId: createdScents[7].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Merci d'exister",
      subTitle: "Quand la gratitude devient lumi√®re",
      description:
        '"Merci d\'exister" est une bougie-hommage. Un geste simple mais puissant pour dire merci √† une personne qui compte √©norm√©ment : un ami, un proche, un amour, un guide. Une mani√®re lumineuse de faire briller sa reconnaissance.',
      price: 49.99,
      categoryId: createdCategories[1].id, // Vie sociale
      slogan: "Quand la gratitude devient lumi√®re",
      arAnimation: "champ-dore",
      scentId: createdScents[8].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Revenir √† toi",
      subTitle: "Parce que certains liens m√©ritent une seconde chance",
      description:
        "\"Revenir √† toi\" est une bougie con√ßue pour raviver une flamme. Elle porte l'espoir d'un retour, d'une reconnexion, d'une histoire qui m√©rite un nouveau souffle. Id√©ale pour ceux qui veulent tendre la main, reprendre contact ou r√©ouvrir une porte ferm√©e.",
      price: 49.99,
      categoryId: createdCategories[0].id, // Amours et liens
      slogan: "Parce que certains liens m√©ritent une seconde chance",
      arAnimation: "chemins-rejoignent",
      scentId: createdScents[9].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    // Nouveaux produits pour "Travail et transition"
    {
      name: "Nouveau d√©part",
      subTitle: "Chaque fin est un nouveau commencement",
      description:
        "\"Nouveau d√©part\" est la bougie parfaite pour accompagner les transitions professionnelles. Que ce soit un changement d'emploi, une promotion ou une reconversion, cette bougie apporte confiance et s√©r√©nit√© pour aborder l'avenir.",
      price: 49.99,
      categoryId: createdCategories[2].id, // Travail et transition
      slogan: "Chaque fin est un nouveau commencement",
      arAnimation: "aube-nouvelle",
      scentId: createdScents[5].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Courage et d√©termination",
      subTitle: "La force int√©rieure qui guide vers le succ√®s",
      description:
        "Cette bougie est con√ßue pour accompagner les moments o√π l'on a besoin de puiser dans ses ressources int√©rieures. Parfaite avant un entretien, une pr√©sentation importante ou un d√©fi professionnel.",
      price: 49.99,
      categoryId: createdCategories[2].id, // Travail et transition
      slogan: "La force int√©rieure qui guide vers le succ√®s",
      arAnimation: "montagne-sommet",
      scentId: createdScents[7].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "√âquilibre vie-travail",
      subTitle: "Retrouver l'harmonie entre toutes ses vies",
      description:
        "Une bougie pour se rappeler l'importance de l'√©quilibre. Elle aide √† d√©compresser apr√®s une journ√©e intense et √† retrouver la paix int√©rieure n√©cessaire √† une vie √©panouie.",
      price: 49.99,
      categoryId: createdCategories[2].id, // Travail et transition
      slogan: "Retrouver l'harmonie entre toutes ses vies",
      arAnimation: "balance-zen",
      scentId: createdScents[2].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    // Nouveaux produits pour "√âmotions et sentiments personnels"
    {
      name: "Accepter qui je suis",
      subTitle: "S'aimer authentiquement, sans masque ni compromis",
      description:
        "Une bougie pour c√©l√©brer l'acceptation de soi. Elle accompagne les moments d'introspection et aide √† cultiver la bienveillance envers soi-m√™me, avec toutes ses imperfections et sa beaut√© unique.",
      price: 49.99,
      categoryId: createdCategories[3].id, // √âmotions et sentiments personnels
      slogan: "S'aimer authentiquement, sans masque ni compromis",
      arAnimation: "miroir-lumiere",
      scentId: createdScents[3].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "L√¢cher prise",
      subTitle: "Lib√©rer ce qui p√®se pour accueillir la l√©g√®ret√©",
      description:
        "Cette bougie accompagne les moments o√π l'on a besoin de se lib√©rer du contr√¥le, des attentes ou des blessures du pass√©. Un rituel de lib√©ration pour faire de la place au nouveau.",
      price: 49.99,
      categoryId: createdCategories[3].id, // √âmotions et sentiments personnels
      slogan: "Lib√©rer ce qui p√®se pour accueillir la l√©g√®ret√©",
      arAnimation: "plumes-vent",
      scentId: createdScents[1].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Confiance en moi",
      subTitle: "Rallumer la flamme de l'estime de soi",
      description:
        "Une bougie pour se reconnecter √† sa valeur int√©rieure. Elle accompagne les moments de doute et aide √† retrouver confiance en ses capacit√©s et en sa worth.",
      price: 49.99,
      categoryId: createdCategories[3].id, // √âmotions et sentiments personnels
      slogan: "Rallumer la flamme de l'estime de soi",
      arAnimation: "etoile-brillante",
      scentId: createdScents[8].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
    {
      name: "Gu√©rison int√©rieure",
      subTitle: "Le temps et la douceur qui apaisent les blessures",
      description:
        "Cette bougie accompagne les processus de gu√©rison √©motionnelle. Elle offre r√©confort et espoir dans les moments difficiles, rappelant que chaque blessure peut devenir une force.",
      price: 49.99,
      categoryId: createdCategories[3].id, // √âmotions et sentiments personnels
      slogan: "Le temps et la douceur qui apaisent les blessures",
      arAnimation: "cicatrisation-doree",
      scentId: createdScents[2].id,
      imageUrl: "/asset/IMG_20250328_111936.webp",
    },
  ];

  const createdProducts = [];
  for (const product of products) {
    const createdProduct = await prisma.product.create({
      data: {
        name: product.name,
        subTitle: product.subTitle,
        description: product.description,
        price: product.price,
        categoryId: product.categoryId,
        slogan: product.slogan,
        arAnimation: product.arAnimation,
        scentId: product.scentId,
        images: {
          create: {
            url: product.imageUrl,
          },
        },
      },
      include: {
        images: true,
      },
    });
    createdProducts.push(createdProduct);
  }

  // Cr√©ation des utilisateurs
  const users = await Promise.all(
    Array.from({ length: 20 }).map(async () => {
      return prisma.user.create({
        data: {
          id: faker.string.uuid(),
          email: faker.internet.email(),
          name: faker.person.fullName(),
          role: "user",
          image: faker.image.avatar(),
          emailVerified: true,
          createdAt: faker.date.past(),
          updatedAt: faker.date.recent(),
        },
      });
    })
  );

  // Cr√©ation des avis
  for (const product of createdProducts) {
    const numberOfReviews = faker.number.int({ min: 3, max: 10 });
    for (let i = 0; i < numberOfReviews; i++) {
      const randomUser = users[Math.floor(Math.random() * users.length)];
      await prisma.review.create({
        data: {
          userId: randomUser.id,
          productId: product.id,
          rating: faker.number.int({ min: 3, max: 5 }),
          comment: faker.lorem.paragraph(),
        },
      });
    }
  }

  // Cr√©ation des commandes avec QR codes
  for (let i = 0; i < 30; i++) {
    const randomUser = users[Math.floor(Math.random() * users.length)];
    const randomProduct =
      createdProducts[Math.floor(Math.random() * createdProducts.length)];
    const quantity = faker.number.int({ min: 1, max: 3 });
    const total = randomProduct.price * quantity;

    await prisma.order.create({
      data: {
        userId: randomUser.id,
        status: faker.helpers.arrayElement([
          "PENDING",
          "PROCESSING",
          "SHIPPED",
          "DELIVERED",
          "CANCELLED",
        ]),
        total,
        items: {
          create: {
            productId: randomProduct.id,
            scentId: randomProduct.scentId,
            quantity,
            price: randomProduct.price,
            qrCode: {
              create: {
                code: faker.string.alphanumeric(10),
              },
            },
          },
        },
        shippingAddress: {
          create: {
            street: faker.location.streetAddress(),
            city: faker.location.city(),
            state: faker.location.state(),
            zipCode: faker.location.zipCode(),
            country: "France",
          },
        },
      },
    });
  }

  console.log("Base de donn√©es peupl√©e avec succ√®s !");
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
